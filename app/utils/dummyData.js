import * as math from 'mathjs';
import spectrum from '@app/utils/syntheticSpectrum';
import {wavelength2ramanshift} from '@app/helpers/deviceRequests';

const baselineALS = (y, lambda, p, niter=100) => {
  //const L = y.length
  //const D = math.add(math.SparseMatrix.diagonal([L, L-2], 1, 0), math.SparseMatrix.diagonal([L, L-2], -2, -1), math.SparseMatrix.diagonal([L, L-2], 1, -2))
  //const lambdaDDt = math.multiply(lambda, math.multiply(D, math.transpose(D)))
  //let w = math.ones(L)
  //let z = math.ones(L)
  //for(let i = 0; i < niter; i++) {
    //let W = math.SparseMatrix.diagonal([L, L], w, 0)
    //let Z = math.add(W, lambdaDDt)
    //z = math.lusolve(Z, math.dotMultiply(w, y)).valueOf().flat()
    //w = math.add(math.multiply(p, math.larger(y, z)), math.multiply(1 - p, math.smaller(y, z)))
  //}


  //return z.map((v,i) => [i,v]);
  return y.map((v,i) => [i,v]);
};

export const synthetic = baselineALS(spectrum.map((v,i) => v[1]), 1e7, 0.05);

const paso = (598 - 528) / 3694
export const linearSpectrum = Array.from({ length: 3694 }, (_, i) => i+1).map((v,i) => [wavelength2ramanshift(528 + i * paso, 520),i/3694]);
console.log(linearSpectrum)

export const siliconSpectrumPoints = normalizeY([
  [86.70313, 10.91968],
  [88.63159, 10.03891],
  [90.56006, 10.01891],
  [92.48853, 11.58693],
  [94.41699, 13.13167],
  [96.34546, 14.09748],
  [98.27393, 14.74413],
  [100.2024, 16.28508],
  [102.1309, 19.50182],
  [104.0593, 23.46800],
  [105.9878, 27.48996],
  [107.9163, 31.38183],
  [109.8447, 35.51846],
  [111.7732, 40.23566],
  [113.7017, 45.66421],
  [115.6301, 50.43421],
  [117.5586, 54.17401],
  [119.4871, 57.22827],
  [121.4155, 60.38366],
  [123.3440, 63.65138],
  [125.2725, 66.99992],
  [127.2009, 69.24345],
  [129.1294, 69.12314],
  [131.0579, 69.08456],
  [132.9863, 69.43196],
  [134.9148, 69.88504],
  [136.8433, 69.80743],
  [138.7717, 68.69198],
  [140.7002, 67.41325],
  [142.6287, 66.45384],
  [144.5571, 65.87560],
  [146.4856, 65.33871],
  [148.4141, 64.66507],
  [150.3425, 63.84234],
  [152.2710, 63.36586],
  [154.1995, 63.56126],
  [156.1279, 63.88052],
  [158.0564, 63.76429],
  [159.9849, 63.10726],
  [161.9133, 62.28347],
  [163.8418, 61.27982],
  [165.7703, 59.83844],
  [167.6987, 59.13599],
  [169.6272, 59.70310],
  [171.5557, 60.81648],
  [173.4841, 61.56701],
  [175.4126, 61.66431],
  [177.3411, 61.61354],
  [179.2695, 61.50568],
  [181.1980, 61.28596],
  [183.1265, 61.22892],
  [185.0549, 61.45217],
  [186.9834, 61.86066],
  [188.9119, 62.29261],
  [190.8403, 62.60784],
  [192.7688, 63.04796],
  [194.6973, 63.84470],
  [196.6257, 65.06342],
  [198.5542, 66.09678],
  [200.4827, 66.70434],
  [202.4111, 66.98746],
  [204.3396, 67.39000],
  [206.2681, 67.96033],
  [208.1965, 68.59087],
  [210.1250, 69.16705],
  [212.0535, 69.54453],
  [213.9819, 70.25845],
  [215.9104, 71.53352],
  [217.8389, 73.28382],
  [219.7673, 74.88027],
  [221.6958, 76.12038],
  [223.6243, 77.39472],
  [225.5527, 78.92735],
  [227.4812, 80.95360],
  [229.4097, 82.98289],
  [231.3381, 85.24650],
  [233.2666, 87.53978],
  [235.1951, 89.21983],
  [237.1235, 89.60468],
  [239.0520, 89.69826],
  [240.9805, 90.06618],
  [242.9089, 90.65337],
  [244.8374, 91.56930],
  [246.7659, 93.30547],
  [248.6943, 95.54417],
  [250.6228, 97.01591],
  [252.5513, 96.71761],
  [254.4797, 96.18948],
  [256.4082, 96.55840],
  [258.3367, 98.04705],
  [260.2651, 99.60414],
  [262.1936, 100.9779],
  [264.1221, 102.1923],
  [266.0505, 103.4281],
  [267.9790, 104.9572],
  [269.9075, 106.3079],
  [271.8359, 107.0131],
  [273.7644, 106.8290],
  [275.6929, 106.9472],
  [277.6213, 107.7567],
  [279.5498, 109.1682],
  [281.4783, 110.4889],
  [283.4067, 111.8806],
  [285.3352, 113.0676],
  [287.2637, 113.8080],
  [289.1921, 113.7964],
  [291.1206, 114.2939],
  [293.0491, 115.8416],
  [294.9775, 118.1427],
  [296.9060, 119.9362],
  [298.8345, 121.1331],
  [300.7629, 121.9205],
  [302.6914, 122.4851],
  [304.6199, 122.9564],
  [306.5483, 122.8107],
  [308.4768, 122.2289],
  [310.4053, 120.9186],
  [312.3337, 118.4868],
  [314.2622, 113.9209],
  [316.1907, 109.4439],
  [318.1191, 105.9902],
  [320.0476, 104.0515],
  [321.9761, 102.1976],
  [323.9045, 100.5107],
  [325.8330, 98.89001],
  [327.7615, 97.18066],
  [329.6899, 95.03849],
  [331.6184, 93.25801],
  [333.5469, 92.29863],
  [335.4753, 92.42652],
  [337.4038, 91.89174],
  [339.3322, 90.02481],
  [341.2607, 87.77306],
  [343.1892, 86.01198],
  [345.1176, 85.07479],
  [347.0461, 84.29308],
  [348.9746, 83.65121],
  [350.9030, 83.12759],
  [352.8315, 82.50551],
  [354.7600, 81.67738],
  [356.6884, 80.81604],
  [358.6169, 80.03327],
  [360.5454, 79.40233],
  [362.4738, 78.75275],
  [364.4023, 78.07944],
  [366.3308, 77.37362],
  [368.2592, 76.63161],
  [370.1877, 75.77940],
  [372.1162, 74.95879],
  [374.0446, 74.23509],
  [375.9731, 73.64556],
  [377.9016, 73.08859],
  [379.8300, 72.65019],
  [381.7585, 72.22101],
  [383.6870, 71.67445],
  [385.6154, 70.98542],
  [387.5439, 70.19634],
  [389.4724, 69.15331],
  [391.4008, 67.83110],
  [393.3293, 67.03275],
  [395.2578, 67.22984],
  [397.1862, 67.68182],
  [399.1147, 67.81734],
  [401.0432, 67.34586],
  [402.9716, 66.96223],
  [404.9001, 66.77305],
  [406.8286, 66.74690],
  [408.7570, 66.74418],
  [410.6855, 66.93781],
  [412.6140, 66.94720],
  [414.5424, 66.57847],
  [416.4709, 65.55977],
  [418.3994, 64.71230],
  [420.3279, 64.03279],
  [422.2563, 63.53492],
  [424.1848, 63.19374],
  [426.1133, 63.03860],
  [428.0417, 63.00462],
  [429.9702, 63.14428],
  [431.8987, 63.46300],
  [433.8271, 63.57014],
  [435.7556, 63.34425],
  [437.6841, 63.00091],
  [439.6125, 62.65475],
  [441.5410, 62.28864],
  [443.4695, 61.96745],
  [445.3979, 61.43837],
  [447.3264, 60.97039],
  [449.2549, 61.19184],
  [451.1833, 62.16174],
  [453.1118, 63.63533],
  [455.0403, 64.75304],
  [456.9687, 65.22801],
  [458.8972, 69.26314],
  [460.8257, 72.39963],
  [462.7541, 81.32301],
  [464.6826, 102.0732],
  [466.6111, 132.6794],
  [468.5395, 175.9852],
  [470.4680, 242.4749],
  [472.3965, 322.6428],
  [474.3249, 393.1251],
  [476.2534, 458.5426],
  [478.1819, 510.4543],
  [480.1103, 543.6625],
  [482.0388, 559.4325],
  [483.9673, 563.2424],
  [485.8957, 542.1447],
  [487.8242, 517.4617],
  [489.7527, 503.2122],
  [491.6811, 495.1064],
  [493.6096, 504.9392],
  [495.5381, 538.1188],
  [497.4665, 590.3920],
  [499.3950, 652.1794],
  [501.3235, 722.9364],
  [503.2519, 804.7640],
  [505.1804, 897.9915],
  [507.1089, 1004.034],
  [509.0373, 1118.141],
  [510.9658, 1208.158],
  [512.8943, 1330.993],
  [514.8228, 1525.769],
  [516.7512, 1817.383],
  [518.6797, 2099.573],
  [520.6082, 2452.768],
  [522.5366, 2773.419],
  [524.4651, 2835.284],
  [526.3936, 2553.636],
  [528.3220, 2201.787],
  [530.2505, 1836.999],
  [532.1790, 1464.069],
  [534.1074, 1143.325],
  [536.0359, 884.4147],
  [537.9644, 671.3290],
  [539.8928, 504.2164],
  [541.8213, 384.6702],
  [543.7498, 292.0281],
  [545.6782, 235.5791],
  [547.6067, 200.4642],
  [549.5352, 172.3448],
  [551.4636, 154.9120],
  [553.3921, 140.6047],
  [555.3206, 129.3277],
  [557.2490, 120.8814],
  [559.1775, 113.8713],
  [561.1060, 108.8981],
  [563.0344, 104.5864],
  [564.9629, 100.3562],
  [566.8914, 96.18245],
  [568.8198, 92.31538],
  [570.7483, 88.71920],
  [572.6768, 85.41811],
  [574.6052, 82.33689],
  [576.5337, 79.39076],
  [578.4622, 77.13750],
  [580.3906, 76.21265],
  [582.3190, 75.85687],
  [584.2475, 75.18177],
  [586.1760, 73.70750],
  [588.1044, 72.47972],
  [590.0329, 71.68257],
  [591.9614, 71.22666],
  [593.8898, 70.88387],
  [595.8183, 70.56934],
  [597.7468, 70.47388],
  [599.6752, 70.64483],
  [601.6037, 71.09746],
  [603.5322, 71.80061],
  [605.4606, 73.19979],
  [607.3891, 74.48347],
  [609.3176, 75.04044],
  [611.2460, 74.76543],
  [613.1745, 74.79017],
  [615.1030, 75.58736],
  [617.0314, 76.63192],
  [618.9599, 77.40935],
  [620.8884, 78.01159],
  [622.8168, 78.19151],
  [624.7453, 77.76680],
  [626.6738, 76.90199],
  [628.6022, 75.85928],
  [630.5307, 74.55861],
  [632.4592, 73.22121],
  [634.3876, 71.74789],
  [636.3161, 70.21968],
  [638.2446, 69.20336],
  [640.1730, 69.10740],
  [642.1015, 69.04906],
  [644.0300, 68.52037],
  [645.9584, 67.52569],
  [647.8869, 66.85689],
  [649.8154, 66.95168],
  [651.7438, 67.11168],
  [653.6723, 66.80813],
  [655.6008, 65.84206],
  [657.5292, 65.26827],
  [659.4577, 65.58271],
  [661.3862, 66.14275],
  [663.3146, 66.38073],
  [665.2431, 66.20502],
  [667.1716, 65.89004],
  [669.1000, 65.41206],
  [671.0285, 64.85098],
  [672.9570, 64.36470],
  [674.8854, 64.01681],
  [676.8139, 63.60584],
  [678.7424, 63.03945],
  [680.6708, 62.35713],
  [682.5993, 61.64542],
  [684.5278, 60.96770],
  [686.4562, 60.18435],
  [688.3847, 59.15405],
  [690.3132, 57.91967],
  [692.2416, 56.94128],
  [694.1701, 56.28413],
  [696.0986, 55.82448],
  [698.0270, 55.54507],
  [699.9555, 55.45758],
  [701.8840, 55.32069],
  [703.8124, 55.29549],
  [705.7409, 55.07603],
  [707.6694, 54.33195],
  [709.5978, 52.97527],
  [711.5263, 51.90023],
  [713.4548, 51.31944],
  [715.3832, 50.99418],
  [717.3117, 50.74357],
  [719.2402, 50.56725],
  [721.1686, 50.49563],
  [723.0971, 50.52454],
  [725.0256, 50.65822],
  [726.9540, 50.92495],
  [728.8825, 51.34120],
  [730.8110, 51.79714],
  [732.7394, 52.43118],
  [734.6679, 53.02195],
  [736.5964, 53.24306],
  [738.5248, 52.71437],
  [740.4533, 52.41517],
  [742.3818, 52.73679],
  [744.3102, 53.34434],
  [746.2387, 53.43125],
  [748.1672, 52.58118],
  [750.0956, 52.14623],
  [752.0241, 52.95127],
  [753.9526, 54.50010],
  [755.8810, 55.59264],
  [757.8095, 55.78628],
  [759.7380, 55.99354],
  [761.6664, 56.54451],
  [763.5949, 57.28894],
  [765.5234, 57.55322],
  [767.4518, 57.01340],
  [769.3803, 56.49685],
  [771.3088, 56.18136],
  [773.2372, 56.09925],
  [775.1657, 56.56765],
  [777.0942, 58.38780],
  [779.0226, 59.99038],
  [780.9511, 60.76641],
  [782.8796, 60.76163],
  [784.8080, 61.06075],
  [786.7365, 62.10469],
  [788.6650, 62.90508],
  [790.5934, 62.76026],
  [792.5219, 61.79800],
  [794.4504, 61.38900],
  [796.3788, 62.21674],
  [798.3073, 63.08355],
  [800.2358, 63.48169],
  [802.1642, 63.37815],
  [804.0927, 63.51821],
  [806.0212, 63.94789],
  [807.9496, 64.57442],
  [809.8781, 65.46907],
  [811.8066, 66.60246],
  [813.7350, 67.46400],
  [815.6635, 67.74077],
  [817.5920, 67.95854],
  [819.5204, 68.43118],
  [821.4489, 69.22672],
  [823.3774, 69.58365],
  [825.3058, 69.17026],
  [827.2343, 68.63165],
  [829.1628, 68.27518],
  [831.0912, 68.08506],
  [833.0197, 67.92687],
  [834.9482, 67.82581],
  [836.8766, 67.69818],
  [838.8051, 67.48228],
  [840.7336, 67.15355],
  [842.6620, 66.89114],
  [844.5905, 66.68542],
  [846.5190, 66.55425],
  [848.4474, 66.58829],
  [850.3759, 66.75670],
  [852.3044, 66.77150],
  [854.2328, 66.45096],
  [856.1613, 66.12096],
  [858.0898, 65.89683],
  [860.0182, 65.77940],
  [861.9467, 65.78929],
  [863.8752, 66.08513],
  [865.8036, 66.33788],
  [867.7321, 66.31383],
  [869.6606, 66.08271],
  [871.5891, 66.01151],
  [873.5175, 66.28678],
  [875.4460, 66.54399],
  [877.3745, 66.51624],
  [879.3029, 66.20721],
  [881.2314, 66.34447],
  [883.1599, 67.00475],
  [885.0883, 67.97433],
  [887.0168, 69.16499],
  [888.9453, 70.61568],
  [890.8737, 72.44093],
  [892.8022, 74.68385],
  [894.7307, 77.23959],
  [896.6591, 80.37228],
  [898.5876, 83.87581],
  [900.5161, 86.62764],
  [902.4445, 87.69238],
  [904.3730, 89.07404],
  [906.3015, 91.35953],
  [908.2299, 94.29205],
  [910.1584, 96.91125],
  [912.0869, 98.69714],
  [914.0153, 101.2862],
  [915.9438, 105.6907],
  [917.8723, 111.1957],
  [919.8007, 116.5478],
  [921.7292, 121.4119],
  [923.6577, 126.7372],
  [925.5861, 132.0741],
  [927.5146, 138.1132],
  [929.4431, 146.2540],
  [931.3715, 157.0715],
  [933.3000, 168.1489],
  [935.2285, 179.5203],
  [937.1569, 190.7623],
  [939.0854, 201.6543],
  [941.0139, 212.4750],
  [942.9423, 221.8572],
  [944.8708, 229.9693],
  [946.7993, 236.2919],
  [948.7277, 240.1364],
  [950.6562, 240.7094],
  [952.5847, 240.6523],
  [954.5131, 239.9040],
  [956.4416, 238.6164],
  [958.3701, 236.6187],
  [960.2985, 234.0493],
  [962.2270, 231.9843],
  [964.1555, 231.0962],
  [966.0839, 230.1747],
  [968.0124, 228.7868],
  [969.9409, 226.9217],
  [971.8693, 224.3658],
  [973.7978, 220.7439],
  [975.7263, 216.8261],
  [977.6547, 213.1229],
  [979.5832, 209.2633],
  [981.5117, 204.2303],
  [983.4401, 197.8355],
  [985.3686, 190.7216],
  [987.2971, 183.2922],
  [989.2255, 175.2764],
  [991.1540, 166.0337],
  [993.0825, 154.7033],
  [995.0109, 143.7213],
  [996.9394, 133.1926],
  [998.8679, 123.3032],
  [1000.796, 114.2989],
  [1002.725, 106.1203],
  [1004.653, 98.88946],
  [1006.582, 92.84792],
  [1008.510, 87.58530],
  [1010.439, 82.78851],
  [1012.367, 78.43438],
  [1014.296, 74.62694],
  [1016.224, 71.86937],
  [1018.153, 69.20212],
  [1020.081, 66.21103],
  [1022.009, 62.90902],
  [1023.938, 59.75704],
  [1025.866, 56.55900],
  [1027.795, 53.72876],
  [1029.723, 51.64236],
  [1031.652, 49.98540],
  [1033.580, 47.93979],
  [1035.509, 45.24891],
  [1037.437, 42.86747],
  [1039.366, 41.28137],
  [1041.294, 40.07357],
  [1043.223, 38.79487],
  [1045.151, 37.42375],
  [1047.080, 36.02544],
  [1049.008, 34.29000],
  [1050.937, 32.77345],
  [1052.865, 31.97332],
  [1054.793, 31.95206],
  [1056.722, 31.99265],
  [1058.650, 32.19072],
  [1060.579, 32.29551],
  [1062.507, 32.17571],
  [1064.436, 31.85781],
  [1066.364, 31.39045],
  [1068.293, 30.63842],
  [1070.221, 29.96537],
  [1072.150, 29.43227],
  [1074.078, 29.04714],
  [1076.006, 28.82898],
  [1077.935, 28.84609],
  [1079.863, 28.93325],
  [1081.792, 29.32135],
  [1083.720, 29.62272],
  [1085.649, 29.32264],
  [1087.577, 28.43696],
  [1089.506, 27.87397],
  [1091.434, 27.91407],
  [1093.363, 28.14022],
  [1095.291, 28.40964],
  [1097.220, 28.70879],
  [1099.148, 28.85875],
  [1101.077, 28.83079],
  [1103.005, 28.67519],
  [1104.933, 28.40833],
  [1106.862, 28.01482],
  [1108.790, 27.38756],
  [1110.719, 26.29931],
  [1112.647, 25.61888],
  [1114.576, 25.83119],
  [1116.504, 26.23704],
  [1118.433, 26.28383],
  [1120.361, 25.99172],
  [1122.290, 25.72373],
  [1124.218, 25.52020],
  [1126.147, 25.36549],
  [1128.075, 25.30134],
  [1130.004, 25.29329],
  [1131.932, 25.17238],
  [1133.860, 24.73700],
  [1135.789, 24.45153],
  [1137.717, 24.51610],
  [1139.646, 24.68480],
  [1141.574, 24.64372],
  [1143.503, 24.39070],
  [1145.431, 24.04155],
  [1147.360, 23.46183],
  [1149.288, 22.94953],
  [1151.217, 22.66108],
  [1153.145, 22.57946],
  [1155.074, 22.65401],
  [1157.002, 22.96748],
  [1158.931, 23.29720],
  [1160.859, 23.81356],
  [1162.787, 24.22781],
  [1164.716, 24.02383],
  [1166.644, 22.57493],
  [1168.573, 21.58832],
  [1170.501, 21.36006],
  [1172.430, 21.35246],
  [1174.358, 21.16555],
  [1176.287, 20.84537],
  [1178.215, 20.75561],
  [1180.144, 21.00696],
  [1182.072, 21.34060],
  [1184.001, 21.79781],
  [1185.929, 22.22657],
  [1187.858, 22.31510],
  [1189.786, 21.93127],
  [1191.714, 21.60314],
  [1193.643, 21.33508],
  [1195.571, 21.20466],
  [1197.500, 21.27400],
  [1199.428, 21.54748],
  [1201.357, 21.93630],
  [1203.285, 22.78678],
  [1205.214, 23.31796],
  [1207.142, 23.17768],
  [1209.071, 22.62648],
  [1210.999, 22.08852],
  [1212.928, 21.54949],
  [1214.856, 21.11110],
  [1216.785, 20.71791],
  [1218.713, 20.52577],
  [1220.641, 20.76628],
  [1222.570, 21.37533],
  [1224.498, 21.60267],
  [1226.427, 21.16026],
  [1228.355, 20.69494],
  [1230.284, 20.14021],
  [1232.212, 19.74552],
  [1234.141, 19.96788],
  [1236.069, 21.36850],
  [1237.998, 22.00041],
  [1239.926, 21.15867],
  [1241.855, 20.24583],
  [1243.783, 20.06035],
  [1245.712, 20.42420],
  [1247.640, 20.62570],
  [1249.568, 20.57850],
  [1251.497, 20.57399],
  [1253.425, 20.76418],
  [1255.354, 20.99210],
  [1257.282, 21.12514],
  [1259.211, 21.16152],
  [1261.139, 21.13433],
  [1263.068, 20.99500],
  [1264.996, 20.85707],
  [1266.925, 20.67535],
  [1268.853, 20.53670],
  [1270.782, 20.64440],
  [1272.710, 21.27920],
  [1274.639, 21.71321],
  [1276.567, 21.96996],
  [1278.495, 22.00276],
  [1280.424, 21.61502],
  [1282.352, 20.89781],
  [1284.281, 20.54691],
  [1286.209, 20.72463],
  [1288.138, 20.91678],
  [1290.066, 20.87012],
  [1291.995, 20.82526],
  [1293.923, 21.11292],
  [1295.852, 21.74206],
  [1297.780, 22.02339],
  [1299.709, 21.65291],
  [1301.637, 21.23807],
  [1303.566, 20.94862],
  [1305.494, 20.78404],
  [1307.422, 20.77130],
  [1309.351, 21.09252],
  [1311.279, 21.15424],
  [1313.208, 20.70129],
  [1315.136, 20.22032],
  [1317.065, 19.90056],
  [1318.993, 19.76306],
  [1320.922, 19.95216],
  [1322.850, 20.67668],
  [1324.779, 21.26071],
  [1326.707, 21.60749],
  [1328.636, 21.74363],
  [1330.564, 21.58091],
  [1332.493, 21.18287],
  [1334.421, 20.95098],
  [1336.349, 21.01253],
  [1338.278, 21.03526],
  [1340.206, 20.79142],
  [1342.135, 20.50521],
  [1344.063, 20.44655],
  [1345.992, 20.64908],
  [1347.920, 20.76262],
  [1349.849, 20.73291],
  [1351.777, 20.64379],
  [1353.706, 20.42455],
  [1355.634, 20.19678],
  [1357.563, 20.21332],
  [1359.491, 20.74120],
  [1361.420, 20.88894],
  [1363.348, 20.17677],
  [1365.276, 19.61011],
  [1367.205, 19.81491],
  [1369.133, 20.49636],
  [1371.062, 20.85104],
  [1372.990, 20.84513],
  [1374.919, 20.68988],
  [1376.847, 20.23553],
  [1378.776, 19.82189],
  [1380.704, 19.61871],
  [1382.633, 19.61468],
  [1384.561, 19.86806],
  [1386.490, 20.51294],
  [1388.418, 20.90072],
  [1390.347, 20.64565],
  [1392.275, 20.28930],
  [1394.203, 20.16728],
  [1396.132, 20.24892],
  [1398.060, 20.32396],
  [1399.989, 20.33545],
  [1401.917, 20.45172],
  [1403.846, 20.81577],
  [1405.774, 21.18725],
  [1407.703, 21.41352],
  [1409.631, 21.49516],
  [1411.560, 21.44912],
  [1413.488, 21.03370],
  [1415.417, 20.83820],
  [1417.345, 21.13873],
  [1419.274, 21.51718],
  [1421.202, 21.53772],
  [1423.130, 21.23569],
  [1425.059, 21.28978],
  [1426.987, 22.00088],
  [1428.916, 22.46955],
  [1430.844, 22.32033],
  [1432.773, 21.96003],
  [1434.701, 21.75849],
  [1436.630, 21.66491],
  [1438.558, 21.36230],
  [1440.487, 20.64805],
  [1442.415, 20.23681],
  [1444.344, 20.76120],
  [1446.272, 21.33187],
  [1448.201, 21.08820],
  [1450.129, 20.19795],
  [1452.057, 19.83955],
  [1453.986, 20.30525],
  [1455.914, 20.75273],
  [1457.843, 21.00911],
  [1459.771, 21.10693],
  [1461.700, 21.02008],
  [1463.628, 20.75882],
  [1465.557, 20.51488],
  [1467.485, 20.20994],
  [1469.414, 20.07201],
  [1471.342, 20.41650],
  [1473.271, 20.67102],
  [1475.199, 20.21438],
  [1477.128, 19.21685],
  [1479.056, 18.88475],
  [1480.984, 20.11858],
  [1482.913, 20.66474],
  [1484.841, 19.78838],
  [1486.770, 18.83775],
  [1488.698, 18.72261],
  [1490.627, 19.22655],
  [1492.555, 19.56305],
  [1494.484, 19.76197],
  [1496.412, 19.71922],
  [1498.341, 18.97876],
  [1500.269, 18.45577],
  [1502.198, 18.91998],
  [1504.126, 19.85845],
  [1506.055, 20.13980],
  [1507.983, 19.68159],
  [1509.911, 19.31391],
  [1511.840, 19.18749],
  [1513.768, 19.14806],
  [1515.697, 19.25218],
  [1517.625, 19.33118],
  [1519.554, 19.03127],
  [1521.482, 18.34366],
  [1523.411, 18.12234],
  [1525.339, 18.81722],
  [1527.268, 19.33394],
  [1529.196, 18.98844],
  [1531.125, 18.43921],
  [1533.053, 18.30939],
  [1534.982, 18.58740],
  [1536.910, 19.02892],
  [1538.839, 19.88125],
  [1540.767, 20.34153],
  [1542.695, 19.84192],
  [1544.624, 19.23812],
  [1546.552, 19.21807],
  [1548.481, 19.66096],
  [1550.409, 19.72915],
  [1552.338, 19.06571],
  [1554.266, 18.83765],
  [1556.195, 19.62861],
  [1558.123, 20.33711],
  [1560.052, 20.40650],
  [1561.980, 20.01967],
  [1563.909, 19.54699],
  [1565.837, 18.88879],
  [1567.766, 18.43021],
  [1569.694, 18.14449],
  [1571.622, 18.07439],
  [1573.551, 18.52306],
  [1575.479, 19.00772],
  [1577.408, 18.79547],
  [1579.336, 17.83278],
  [1581.265, 17.48753],
  [1583.193, 18.25437],
  [1585.122, 18.85652],
  [1587.050, 19.17870],
  [1588.979, 19.23512],
  [1590.907, 18.84760],
  [1592.836, 18.18943],
  [1594.764, 17.92036],
  [1596.693, 18.13086],
  [1598.621, 18.35324],
  [1600.549, 18.60204],
  [1602.478, 18.77966],
  [1604.406, 18.81870],
  [1606.335, 18.77938],
  [1608.263, 18.74221],
  [1610.192, 18.70723],
  [1612.120, 18.65551],
  [1614.049, 18.58053],
  [1615.977, 18.50279],
  [1617.906, 18.35524],
  [1619.834, 18.27429],
  [1621.763, 18.46081],
  [1623.691, 18.78530],
  [1625.620, 18.82956],
  [1627.548, 18.51286],
  [1629.476, 18.41718],
  [1631.405, 18.72483],
  [1633.333, 19.14505],
  [1635.262, 19.85910],
  [1637.190, 20.40445],
  [1639.119, 20.04611],
  [1641.047, 18.93330],
  [1642.976, 18.33321],
  [1644.904, 18.55656],
  [1646.833, 18.58946],
  [1648.761, 17.74793],
  [1650.690, 17.07205],
  [1652.618, 17.57878],
  [1654.547, 18.61191],
  [1656.475, 18.84706],
  [1658.403, 18.22453],
  [1660.332, 17.90007],
  [1662.260, 18.22250],
  [1664.189, 18.45826],
  [1666.117, 18.17575],
  [1668.046, 17.82203],
  [1669.974, 17.77001],
  [1671.903, 17.95467],
  [1673.831, 18.15125],
  [1675.760, 18.35486],
  [1677.688, 18.54692],
  [1679.617, 18.74470],
  [1681.545, 18.89352],
  [1683.474, 19.03464],
  [1685.402, 19.06424],
  [1687.330, 18.74860],
  [1689.259, 18.16318],
  [1691.187, 17.87452],
  [1693.116, 17.96589],
  [1695.044, 18.19776],
  [1696.973, 18.79051],
  [1698.901, 19.14210],
  [1700.830, 18.56620],
  [1702.758, 17.73310],
  [1704.687, 17.79104],
  [1706.615, 18.68980],
  [1708.544, 19.29047],
  [1710.472, 19.51055],
  [1712.401, 19.37396],
  [1714.329, 18.48456],
  [1716.257, 17.71378],
  [1718.186, 17.66981],
  [1720.114, 18.06427],
  [1722.043, 18.38037],
  [1723.971, 18.61480],
  [1725.900, 18.98569],
  [1727.828, 19.70297],
  [1729.757, 20.06605],
  [1731.685, 19.57260],
  [1733.614, 18.96951],
  [1735.542, 18.76629],
  [1737.471, 18.78732],
  [1739.399, 18.65323],
  [1741.328, 18.35744],
  [1743.256, 18.24875],
  [1745.184, 18.46622],
  [1747.113, 18.61328],
  [1749.041, 18.42342],
  [1750.970, 18.27508],
  [1752.898, 18.50899],
  [1754.827, 18.93028],
  [1756.755, 19.20167],
  [1758.684, 19.31705],
  [1760.612, 19.24865],
  [1762.541, 18.82818],
  [1764.469, 18.67890],
  [1766.398, 19.34961],
  [1768.326, 19.95465],
  [1770.255, 19.79483],
  [1772.183, 19.22857],
  [1774.111, 18.75535],
  [1776.040, 18.38836],
  [1777.968, 18.38384],
  [1779.897, 18.91316],
  [1781.825, 19.35489],
  [1783.754, 19.56019],
  [1785.682, 19.59961],
  [1787.611, 19.30057],
  [1789.539, 18.97507],
  [1791.468, 19.21464],
  [1793.396, 19.92693],
  [1795.325, 20.22390],
  [1797.253, 19.93368],
  [1799.182, 19.65999],
  [1801.110, 19.53905],
  [1803.038, 19.45402],
  [1804.967, 19.32468],
  [1806.895, 19.22470],
  [1808.824, 19.32434],
  [1810.752, 19.55820],
  [1812.681, 19.48129],
  [1814.609, 18.96956],
  [1816.538, 18.63929],
  [1818.466, 18.67557],
  [1820.395, 18.74819],
  [1822.323, 18.70186],
  [1824.252, 18.69727],
  [1826.180, 19.03843],
  [1828.109, 19.51591],
  [1830.037, 19.36731],
  [1831.965, 18.28251],
  [1833.894, 17.99979],
  [1835.822, 19.59826],
  [1837.751, 20.37522],
  [1839.679, 19.11056],
  [1841.608, 17.81402],
  [1843.536, 17.76638],
  [1845.465, 18.36298],
  [1847.393, 18.69479],
  [1849.322, 18.75906],
  [1851.250, 18.78575],
  [1853.179, 18.79181],
  [1855.107, 18.72343],
  [1857.036, 18.37139],
  [1858.964, 18.22729],
  [1860.892, 18.72143],
  [1862.821, 19.24443],
  [1864.749, 19.11676],
  [1866.678, 18.59097],
  [1868.606, 18.53219],
  [1870.535, 19.01901],
  [1872.463, 19.39046],
  [1874.392, 19.61923],
  [1876.320, 19.70378],
  [1878.249, 19.68473],
  [1880.177, 19.46153],
  [1882.106, 18.62938],
  [1884.034, 17.82675],
  [1885.963, 18.05361],
  [1887.891, 19.03840],
  [1889.819, 19.40007],
  [1891.748, 19.00054],
  [1893.676, 18.88683],
  [1895.605, 19.43834],
  [1897.533, 19.75944],
  [1899.462, 19.29404],
  [1901.390, 18.75749],
  [1903.319, 18.60036],
  [1905.247, 18.69933],
  [1907.176, 18.91340],
  [1909.104, 19.22439],
  [1911.033, 19.54862],
  [1912.961, 19.97066],
  [1914.890, 20.01005],
  [1916.818, 19.34113],
  [1918.746, 18.66624],
  [1920.675, 18.02252],
  [1922.603, 17.63650],
  [1924.532, 17.87047],
  [1926.460, 18.39687],
  [1928.389, 18.56827],
  [1930.317, 18.37825],
  [1932.246, 18.25723],
  [1934.174, 18.13701],
  [1936.103, 18.21538],
  [1938.031, 18.67707],
  [1939.960, 19.08564],
  [1941.888, 19.35818],
  [1943.817, 19.49345],
  [1945.745, 19.47702],
  [1947.673, 19.32312],
  [1949.602, 18.90409],
  [1951.530, 18.22364],
  [1953.459, 18.37671],
  [1955.387, 19.68648],
  [1957.316, 20.51434],
  [1959.244, 20.60241],
  [1961.173, 20.26300],
  [1963.101, 19.18462],
  [1965.030, 18.20475],
  [1966.958, 17.90368],
  [1968.887, 18.00542],
  [1970.815, 18.23193],
  [1972.744, 18.54022],
  [1974.672, 18.70618],
  [1976.600, 18.68900],
  [1978.529, 18.84354],
  [1980.457, 19.35851],
  [1982.386, 19.73058],
  [1984.314, 19.75181],
  [1986.243, 19.67406],
  [1988.171, 19.68231],
  [1990.100, 19.62427],
  [1992.028, 19.22552],
  [1993.957, 18.61275],
  [1995.885, 18.22469],
  [1997.814, 18.04001],
  [1999.742, 18.21675],
  [2001.671, 19.24636],
  [2003.599, 19.76842],
  [2005.527, 19.25477],
  [2007.456, 18.80462],
  [2009.384, 18.67652],
  [2011.313, 18.83752],
  [2013.241, 19.64798],
  [2015.170, 20.53842],
  [2017.098, 20.25159],
  [2019.027, 19.00722],
  [2020.955, 18.38244],
  [2022.884, 18.49221],
  [2024.812, 18.59308],
  [2026.741, 18.55422],
  [2028.669, 18.59075],
  [2030.598, 18.87760],
  [2032.526, 19.10215],
  [2034.454, 19.00092],
  [2036.383, 18.84459],
  [2038.311, 19.00281],
  [2040.240, 19.28182],
  [2042.168, 19.15100],
  [2044.097, 18.59367],
  [2046.025, 18.23759],
  [2047.954, 18.10336],
  [2049.882, 18.13432],
  [2051.811, 18.48329],
  [2053.739, 18.77081],
  [2055.668, 18.87593],
  [2057.596, 18.96023],
  [2059.525, 19.15030],
  [2061.453, 19.32140],
  [2063.381, 19.35820],
  [2065.310, 19.26652],
  [2067.238, 18.96836],
  [2069.167, 18.50242],
  [2071.095, 18.44111],
  [2073.024, 18.91763],
  [2074.952, 19.04023],
  [2076.881, 18.36455],
  [2078.809, 18.05177],
  [2080.738, 18.93518],
  [2082.666, 19.70413],
  [2084.594, 19.61331],
  [2086.523, 19.16937],
  [2088.451, 18.67673],
  [2090.380, 18.27907],
  [2092.308, 18.40291],
  [2094.237, 19.02481],
  [2096.165, 19.34420],
  [2098.094, 19.25769],
  [2100.022, 19.18843],
  [2101.951, 19.19982],
  [2103.879, 19.11382],
  [2105.808, 18.73421],
  [2107.736, 18.49973],
  [2109.665, 18.66494],
  [2111.593, 18.94706],
  [2113.521, 19.29788],
  [2115.450, 19.53845],
  [2117.378, 19.28976],
  [2119.307, 18.73570],
  [2121.235, 18.44946],
  [2123.164, 18.44110],
  [2125.092, 18.79216],
  [2127.021, 19.81717],
  [2128.949, 20.33739],
  [2130.878, 19.80852],
  [2132.806, 19.41294],
  [2134.735, 19.61049],
  [2136.663, 19.73925],
  [2138.592, 19.35252],
  [2140.520, 18.86510],
  [2142.448, 18.60633],
  [2144.377, 18.53822],
  [2146.305, 18.63563],
  [2148.234, 18.86674],
  [2150.162, 19.08430],
  [2152.091, 19.28599],
  [2154.019, 19.45710],
  [2155.948, 19.60550],
  [2157.876, 19.69238],
  [2159.805, 19.76830],
  [2161.733, 19.67295],
  [2163.662, 19.11383],
  [2165.590, 18.68089],
  [2167.519, 18.73716],
  [2169.447, 18.98846],
  [2171.375, 19.28353],
  [2173.304, 19.52312],
  [2175.232, 19.47713],
  [2177.161, 19.20714],
  [2179.089, 19.04704],
  [2181.018, 18.99723],
  [2182.946, 19.11967],
  [2184.875, 19.46830],
  [2186.803, 19.66241],
  [2188.732, 19.62831],
  [2190.660, 19.47272],
  [2192.589, 19.13027],
  [2194.517, 18.81718],
  [2196.446, 18.53185],
  [2198.374, 18.41731],
  [2200.302, 18.71517],
  [2202.231, 19.13300],
  [2204.159, 19.33544],
  [2206.088, 19.35870],
  [2208.016, 19.27497],
  [2209.945, 19.08736],
  [2211.873, 18.84366],
  [2213.802, 18.52277],
  [2215.730, 18.43934],
  [2217.659, 18.66308],
  [2219.587, 18.92586],
  [2221.516, 19.31344],
  [2223.444, 19.40653],
  [2225.373, 18.60740],
  [2227.301, 18.11268],
  [2229.229, 18.80260],
  [2231.158, 19.60974],
  [2233.086, 19.73286],
  [2235.015, 19.50371],
  [2236.943, 19.15587],
  [2238.872, 18.84495],
  [2240.800, 19.11779],
  [2242.729, 19.87013],
  [2244.657, 20.13828],
  [2246.586, 19.91238],
  [2248.514, 19.32391],
  [2250.443, 18.24517],
  [2252.371, 17.75265],
  [2254.300, 18.23878],
  [2256.228, 18.77311],
  [2258.156, 19.21040],
  [2260.085, 19.52595],
  [2262.013, 19.56994],
  [2263.942, 19.65668],
  [2265.870, 20.15729],
  [2267.799, 20.59644],
  [2269.727, 20.37502],
  [2271.656, 19.89566],
  [2273.584, 19.87162],
  [2275.513, 20.09890],
  [2277.441, 19.89170],
  [2279.370, 19.34633],
  [2281.298, 19.14856],
  [2283.227, 19.34216],
  [2285.155, 19.66756],
  [2287.083, 20.20063],
  [2289.012, 20.59500],
  [2290.940, 21.05307],
  [2292.869, 20.98736],
  [2294.797, 19.45658],
  [2296.726, 18.64088],
  [2298.654, 19.76536],
  [2300.583, 21.03404],
  [2302.511, 21.71518],
  [2304.440, 22.04112],
  [2306.368, 22.09750],
  [2308.297, 21.97935],
  [2310.225, 21.64096],
  [2312.154, 21.28535],
  [2314.082, 21.36709],
  [2316.010, 21.83634],
  [2317.939, 22.38207],
  [2319.867, 22.98375],
  [2321.796, 24.15089],
  [2323.724, 26.16491],
  [2325.653, 27.05013],
  [2327.581, 26.44249],
  [2329.510, 25.83714],
  [2331.438, 25.60832],
  [2333.367, 25.00235],
  [2335.295, 23.32569],
  [2337.224, 22.04088],
  [2339.152, 22.09637],
  [2341.081, 22.13590],
  [2343.009, 21.23833],
  [2344.938, 20.28384],
  [2346.866, 20.01874],
  [2348.794, 20.01151],
  [2350.723, 19.76179],
  [2352.651, 19.44072],
  [2354.580, 19.27632],
  [2356.508, 19.30623],
  [2358.437, 19.80801],
  [2360.365, 20.65274],
  [2362.294, 20.81985],
  [2364.222, 20.18756],
  [2366.151, 20.08846],
  [2368.079, 20.90609],
  [2370.008, 21.12844],
  [2371.936, 20.49100],
  [2373.865, 19.99026],
  [2375.793, 19.68572],
  [2377.721, 19.67385],
  [2379.650, 20.14817],
  [2381.578, 20.54821],
  [2383.507, 20.47501],
  [2385.435, 20.53357],
  [2387.364, 21.32945],
  [2389.292, 21.94352],
  [2391.221, 21.69547],
  [2393.149, 21.06824],
  [2395.078, 20.18835],
  [2397.006, 19.44866],
  [2398.935, 19.46333],
  [2400.863, 19.91240],
  [2402.792, 20.27315],
  [2404.720, 20.55046],
  [2406.648, 20.75860],
  [2408.577, 20.89768],
  [2410.505, 20.92813],
  [2412.434, 20.83639],
  [2414.362, 21.00739],
  [2416.291, 21.59906],
  [2418.219, 21.70726],
  [2420.148, 21.22008],
  [2422.076, 20.72220],
  [2424.005, 20.19435],
  [2425.933, 20.00989],
  [2427.862, 20.37280],
  [2429.790, 20.74806],
  [2431.719, 21.00598],
  [2433.647, 21.22078],
  [2435.575, 21.58385],
  [2437.504, 21.67010],
  [2439.432, 21.04741],
  [2441.361, 20.43696],
  [2443.289, 20.21141],
  [2445.218, 20.17462],
  [2447.146, 20.17687],
  [2449.075, 20.31542],
  [2451.003, 20.92456],
  [2452.932, 21.52563],
  [2454.860, 21.36550],
  [2456.789, 20.79771],
  [2458.717, 20.42067],
  [2460.646, 20.22865],
  [2462.574, 20.32872],
  [2464.502, 20.59380],
  [2466.431, 20.29322],
  [2468.359, 19.57555],
  [2470.288, 19.60223],
  [2472.216, 20.43545],
  [2474.145, 21.08568],
  [2476.073, 21.52082],
  [2478.002, 21.83901],
  [2479.930, 22.08982],
  [2481.859, 22.03141],
  [2483.787, 21.59533],
  [2485.716, 21.05551],
  [2487.644, 20.28839],
  [2489.573, 20.03944],
  [2491.501, 20.73086],
  [2493.429, 21.41417],
  [2495.358, 22.11653],
  [2497.286, 22.36004],
  [2499.215, 21.50051],
  [2501.143, 20.92475],
  [2503.072, 21.41080],
  [2505.000, 21.80246],
  [2506.929, 21.55418],
  [2508.857, 21.07930],
  [2510.786, 20.40528],
  [2512.714, 19.87533],
  [2514.643, 19.73173],
  [2516.571, 19.87191],
  [2518.500, 20.45066],
  [2520.428, 21.02386],
  [2522.356, 20.92961],
  [2524.285, 20.64650],
  [2526.213, 20.81994],
  [2528.142, 21.25458],
  [2530.070, 21.84997],
  [2531.999, 22.36311],
  [2533.927, 22.07998],
  [2535.856, 21.30184],
  [2537.784, 21.05085],
  [2539.713, 21.21659],
  [2541.641, 21.15586],
  [2543.570, 20.93917],
  [2545.498, 20.97164],
  [2547.427, 21.24090],
  [2549.355, 21.53466],
  [2551.283, 21.85190],
  [2553.212, 22.05986],
  [2555.140, 22.15319],
  [2557.069, 22.16449],
  [2558.997, 22.09883],
  [2560.926, 21.83955],
  [2562.854, 21.32632],
  [2564.783, 21.19842],
  [2566.711, 21.65615],
  [2568.640, 21.94004],
  [2570.568, 22.03664],
  [2572.497, 21.74584],
  [2574.425, 20.61452],
  [2576.354, 20.24250],
  [2578.282, 21.14054],
  [2580.210, 21.72723],
  [2582.139, 21.51149],
  [2584.067, 21.38532],
  [2585.996, 21.91676],
  [2587.924, 22.05165],
  [2589.853, 21.07047],
  [2591.781, 20.40955],
  [2593.710, 20.48509],
  [2595.638, 20.88682],
  [2597.567, 22.00131],
  [2599.495, 22.45226],
]);

function normalizeY(data) {
  let max = Math.max(...data.map(p => p[1]))
  return data.map(p => [p[0], Math.min(p[1]/max, 1)])
}
